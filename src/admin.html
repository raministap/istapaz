<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - ƒ∞≈üTap.az</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: #f0f2f5; }
        
        /* Login */
        #loginOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; z-index: 9999; }
        .login-box { background: white; padding: 40px; border-radius: 10px; width: 90%; max-width: 400px; text-align: center; }
        .login-box h2 { color: #1a73e8; margin-bottom: 20px; }
        .login-box input { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 5px; font-size: 16px; }
        .login-box button { width: 100%; padding: 12px; background: #1a73e8; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        .login-box button:hover { background: #1557b0; }
        .login-box .error { color: #e74c3c; margin-top: 10px; display: none; font-size: 14px; }
        .login-box .info { color: #666; margin-top: 15px; font-size: 12px; }
        .login-box .info a { color: #1a73e8; }
        
        /* Header */
        .header { background: #1a73e8; color: white; padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; position: fixed; top: 0; left: 0; right: 0; z-index: 100; }
        .header-left { display: flex; align-items: center; gap: 10px; }
        .menu-btn { background: none; border: none; color: white; font-size: 24px; cursor: pointer; padding: 5px; }
        .header h1 { font-size: 18px; }
        .logout-btn { background: #ff4444; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 14px; }
        .logout-btn:hover { background: #cc0000; }
        
        /* Layout */
        .container { display: flex; margin-top: 50px; min-height: calc(100vh - 50px); }
        
        /* Sidebar */
        .sidebar { width: 250px; background: #2c3e50; color: white; position: fixed; left: -250px; top: 50px; bottom: 0; transition: left 0.3s; z-index: 99; overflow-y: auto; }
        .sidebar.open { left: 0; }
        .sidebar-header { padding: 20px; border-bottom: 1px solid #34495e; }
        .sidebar-header h3 { margin: 0; font-size: 16px; }
        .menu-item { padding: 15px 20px; cursor: pointer; border-bottom: 1px solid #34495e; transition: background 0.3s; display: flex; align-items: center; gap: 10px; }
        .menu-item:hover, .menu-item.active { background: #34495e; }
        .menu-item .icon { font-size: 18px; }
        .badge { background: #e74c3c; color: white; padding: 2px 8px; border-radius: 10px; font-size: 11px; margin-left: auto; }
        
        /* Content */
        .content { flex: 1; padding: 20px; margin-left: 0; width: 100%; }
        
        /* Stats */
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .stat-card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border-left: 4px solid #1a73e8; }
        .stat-card h4 { color: #7f8c8d; font-size: 14px; margin-bottom: 10px; }
        .stat-card .number { font-size: 28px; font-weight: bold; color: #2c3e50; }
        
        /* Tables */
        .section { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .section h3 { margin-bottom: 20px; color: #2c3e50; padding-bottom: 10px; border-bottom: 2px solid #1a73e8; }
        table { width: 100%; border-collapse: collapse; font-size: 14px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ecf0f1; }
        th { background: #f8f9fa; color: #2c3e50; font-weight: bold; }
        tr:hover { background: #f8f9fa; }
        .status-badge { padding: 5px 12px; border-radius: 15px; font-size: 12px; font-weight: bold; }
        .status-badge.pending { background: #fff3cd; color: #856404; }
        .status-badge.approved { background: #d4edda; color: #155724; }
        .status-badge.rejected { background: #f8d7da; color: #721c24; }
        
        /* Buttons */
        .btn { padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer; font-size: 13px; margin-right: 5px; transition: opacity 0.2s; }
        .btn:hover { opacity: 0.8; }
        .btn-view { background: #3498db; color: white; }
        .btn-approve { background: #27ae60; color: white; }
        .btn-reject { background: #e74c3c; color: white; }
        .btn-delete { background: #95a5a6; color: white; }
        
        /* Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 2000; justify-content: center; align-items: center; padding: 20px; }
        .modal.show { display: flex; }
        .modal-content { background: white; padding: 30px; border-radius: 10px; max-width: 600px; width: 100%; max-height: 90vh; overflow-y: auto; position: relative; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #1a73e8; }
        .modal-header h2 { color: #1a73e8; margin: 0; }
        .close-btn { background: none; border: none; font-size: 28px; cursor: pointer; color: #666; line-height: 1; }
        .close-btn:hover { color: #000; }
        .detail-row { margin-bottom: 15px; }
        .detail-row label { font-weight: bold; color: #555; display: block; margin-bottom: 5px; font-size: 14px; }
        .detail-row .value { color: #333; line-height: 1.5; }
        .detail-row .value pre { white-space: pre-wrap; font-family: inherit; margin: 0; background: #f8f9fa; padding: 10px; border-radius: 5px; }
        .modal-actions { display: flex; gap: 10px; margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee; flex-wrap: wrap; }
        
        .hidden { display: none !important; }
        
        /* Responsive */
        @media (max-width: 768px) {
            .sidebar { width: 200px; left: -200px; }
            .stats { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <!-- Login Overlay -->
    <div id="loginOverlay">
        <div class="login-box">
            <h2>üîê Admin Giri≈üi</h2>
            <input type="email" id="adminEmail" placeholder="Admin email" value="">
            <input type="password" id="adminPass" placeholder="≈ûifr…ô">
            <button onclick="checkLogin()">Daxil ol</button>
            <p class="error" id="loginError">‚ùå Yanlƒ±≈ü email v…ô ya ≈üifr…ô!</p>
            <p class="info">
                ∆èvv…ôlc…ô saytda <a href="register.html" target="_blank">qeydiyyatdan ke√ßin</a>,<br>
                sonra buradan daxil olun.
            </p>
        </div>
    </div>

    <!-- Main Content -->
    <div id="mainContent" class="hidden">
        <div class="header">
            <div class="header-left">
                <button class="menu-btn" onclick="toggleMenu()">‚ò∞</button>
                <h1>Admin Panel</h1>
            </div>
            <button class="logout-btn" onclick="logout()">üö™ √áƒ±xƒ±≈ü</button>
        </div>
        
        <div class="container">
            <!-- Sidebar -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h3>üìã ƒ∞dar…ôetm…ô Paneli</h3>
                </div>
                <div class="menu-item active" onclick="showSection('dashboard', this)">
                    <span class="icon">üìä</span> Dashboard
                </div>
                <div class="menu-item" onclick="showSection('pending', this)">
                    <span class="icon">‚è≥</span> G√∂zl…ôy…ôn elanlar
                    <span class="badge" id="pendingCountBadge">0</span>
                </div>
                <div class="menu-item" onclick="showSection('approved', this)">
                    <span class="icon">‚úÖ</span> Aktiv elanlar
                </div>
                <div class="menu-item" onclick="showSection('users', this)">
                    <span class="icon">üë•</span> ƒ∞stifad…ô√ßil…ôr
                </div>
            </div>
            
            <!-- Content -->
            <div class="content">
                <!-- Dashboard -->
                <div id="dashboard" class="section-content">
                    <div class="stats">
                        <div class="stat-card">
                            <h4>‚è≥ G√∂zl…ôy…ôn elanlar</h4>
                            <div class="number" id="statPending">0</div>
                        </div>
                        <div class="stat-card">
                            <h4>‚úÖ Aktiv elanlar</h4>
                            <div class="number" id="statApproved">0</div>
                        </div>
                        <div class="stat-card">
                            <h4>üë• √úmumi istifad…ô√ßil…ôr</h4>
                            <div class="number" id="statUsers">0</div>
                        </div>
                        <div class="stat-card">
                            <h4>üìÖ Bug√ºn …ôlav…ô edil…ôn</h4>
                            <div class="number" id="statToday">0</div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <h3>üïê Son …ôlav…ô edil…ôn vakansiyalar</h3>
                        <div id="recentJobsList">
                            <p style="color: #666; padding: 20px;">Y√ºkl…ônir...</p>
                        </div>
                    </div>
                </div>
                
                <!-- Pending Jobs -->
                <div id="pending" class="section-content hidden">
                    <div class="section">
                        <h3>‚è≥ T…ôsdiq g√∂zl…ôy…ôn elanlar</h3>
                        <div id="pendingJobsList">
                            <p style="color: #666; padding: 20px;">Y√ºkl…ônir...</p>
                        </div>
                    </div>
                </div>
                
                <!-- Approved Jobs -->
                <div id="approved" class="section-content hidden">
                    <div class="section">
                        <h3>‚úÖ Aktiv elanlar</h3>
                        <div id="approvedJobsList">
                            <p style="color: #666; padding: 20px;">Y√ºkl…ônir...</p>
                        </div>
                    </div>
                </div>
                
                <!-- Users -->
                <div id="users" class="section-content hidden">
                    <div class="section">
                        <h3>üë• ƒ∞stifad…ô√ßil…ôr</h3>
                        <div id="usersList">
                            <p style="color: #666; padding: 20px;">Y√ºkl…ônir...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Job Detail Modal -->
    <div id="jobModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Vakansiya Detallarƒ±</h2>
                <button class="close-btn" onclick="closeModal()">‚úï</button>
            </div>
            <div id="modalBody"></div>
            <div class="modal-actions" id="modalActions"></div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, getDocs, collection, query, where, orderBy, updateDoc, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCiAg-P6g7MDv-xPsraWjHPmUdg-wGYWJU",
            authDomain: "istap-az.firebaseapp.com",
            projectId: "istap-az",
            storageBucket: "istap-az.firebasestorage.app",
            messagingSenderId: "1014728151709",
            appId: "1:1014728151709:web:8854f5e32d9812c2bffa74"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        let currentJobId = null;
        
        // Check login
        window.checkLogin = async function() {
            const email = document.getElementById('adminEmail').value.trim();
            const password = document.getElementById('adminPass').value;
            const errorDiv = document.getElementById('loginError');
            
            if (!email || !password) {
                errorDiv.textContent = '‚ö†Ô∏è Email v…ô ≈üifr…ô daxil edin!';
                errorDiv.style.display = 'block';
                return;
            }
            
            try {
                await signInWithEmailAndPassword(auth, email, password);
                errorDiv.style.display = 'none';
            } catch (err) {
                console.error('Giri≈ü x…ôtasƒ±:', err);
                if (err.code === 'auth/user-not-found') {
                    errorDiv.textContent = '‚ùå Bu email il…ô istifad…ô√ßi tapƒ±lmadƒ±. ∆èvv…ôlc…ô qeydiyyatdan ke√ßin!';
                } else if (err.code === 'auth/wrong-password') {
                    errorDiv.textContent = '‚ùå ≈ûifr…ô yanlƒ±≈üdƒ±r!';
                } else if (err.code === 'auth/invalid-email') {
                    errorDiv.textContent = '‚ùå Email formatƒ± yanlƒ±≈üdƒ±r!';
                } else {
                    errorDiv.textContent = '‚ùå X…ôta: ' + err.message;
                }
                errorDiv.style.display = 'block';
            }
        };
        
        // Auth state listener
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('loginOverlay').style.display = 'none';
                document.getElementById('mainContent').classList.remove('hidden');
                loadAllData();
            } else {
                document.getElementById('loginOverlay').style.display = 'flex';
                document.getElementById('mainContent').classList.add('hidden');
            }
        });
        
        // Logout
        window.logout = async function() {
            try {
                await signOut(auth);
                window.location.reload();
            } catch (err) {
                console.error('√áƒ±xƒ±≈ü x…ôtasƒ±:', err);
                alert('√áƒ±xƒ±≈ü zamanƒ± x…ôta ba≈ü verdi');
            }
        };
        
        // Toggle menu
        window.toggleMenu = function() {
            document.getElementById('sidebar').classList.toggle('open');
        };
        
        // Show section
        window.showSection = function(sectionId, element) {
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(el => el.classList.add('hidden'));
            // Show selected
            document.getElementById(sectionId).classList.remove('hidden');
            
            // Update menu active state
            document.querySelectorAll('.menu-item').forEach(el => el.classList.remove('active'));
            if (element) element.classList.add('active');
            
            // Close menu on mobile
            document.getElementById('sidebar').classList.remove('open');
            
            // Reload data for this section
            if (sectionId === 'pending') loadPendingJobs();
            if (sectionId === 'approved') loadApprovedJobs();
            if (sectionId === 'users') loadUsers();
        };
        
        // Load all data
        async function loadAllData() {
            await loadStats();
            await loadRecentJobs();
            await loadPendingJobs();
            await loadApprovedJobs();
            await loadUsers();
        }
        
        // Load statistics
        async function loadStats() {
            try {
                // Pending count
                const pendingQuery = query(collection(db, 'jobs'), where('status', '==', 'pending'));
                const pendingSnapshot = await getDocs(pendingQuery);
                const pendingCount = pendingSnapshot.size;
                document.getElementById('statPending').textContent = pendingCount;
                document.getElementById('pendingCountBadge').textContent = pendingCount;
                
                // Approved count
                const approvedQuery = query(collection(db, 'jobs'), where('status', '==', 'approved'));
                const approvedSnapshot = await getDocs(approvedQuery);
                document.getElementById('statApproved').textContent = approvedSnapshot.size;
                
                // Users count
                const usersSnapshot = await getDocs(collection(db, 'users'));
                document.getElementById('statUsers').textContent = usersSnapshot.size;
                
                // Today count
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                let todayCount = 0;
                const allJobsSnapshot = await getDocs(collection(db, 'jobs'));
                allJobsSnapshot.forEach(doc => {
                    const job = doc.data();
                    if (job.createdAt && job.createdAt.toDate() >= today) {
                        todayCount++;
                    }
                });
                document.getElementById('statToday').textContent = todayCount;
                
            } catch (err) {
                console.error('Statistika x…ôtasƒ±:', err);
            }
        }
        
        // Load recent jobs
        async function loadRecentJobs() {
            try {
                const q = query(collection(db, 'jobs'), orderBy('createdAt', 'desc'));
                const snapshot = await getDocs(q);
                
                if (snapshot.empty) {
                    document.getElementById('recentJobsList').innerHTML = '<p style="color: #666; padding: 20px;">H…ôl…ô he√ß bir elan yoxdur.</p>';
                    return;
                }
                
                let html = '<table><thead><tr><th>Vakansiya</th><th>≈ûirk…ôt</th><th>Status</th><th>∆èm…ôliyyat</th></tr></thead><tbody>';
                
                let count = 0;
                snapshot.forEach((doc) => {
                    if (count >= 10) return; // Show only last 10
                    const job = doc.data();
                    const statusClass = job.status === 'approved' ? 'approved' : (job.status === 'rejected' ? 'rejected' : 'pending');
                    const statusText = job.status === 'approved' ? 'T…ôsdiql…ônib' : (job.status === 'rejected' ? 'R…ôdd edilib' : 'G√∂zl…ôyir');
                    
                    html += `
                        <tr>
                            <td>${job.title}</td>
                            <td>${job.company}</td>
                            <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                            <td>
                                <button class="btn btn-view" onclick="viewJob('${doc.id}')">üëÅ Bax</button>
                            </td>
                        </tr>
                    `;
                    count++;
                });
                
                html += '</tbody></table>';
                document.getElementById('recentJobsList').innerHTML = html;
                
            } catch (err) {
                document.getElementById('recentJobsList').innerHTML = '<p style="color: #e74c3c; padding: 20px;">X…ôta ba≈ü verdi!</p>';
            }
        }
        
        // Load pending jobs
        async function loadPendingJobs() {
            try {
                const q = query(collection(db, 'jobs'), where('status', '==', 'pending'), orderBy('createdAt', 'desc'));
                const snapshot = await getDocs(q);
                
                if (snapshot.empty) {
                    document.getElementById('pendingJobsList').innerHTML = '<p style="color: #666; padding: 20px;">G√∂zl…ôy…ôn elan yoxdur.</p>';
                    return;
                }
                
                let html = '<table><thead><tr><th>Vakansiya</th><th>≈ûirk…ôt</th><th>≈û…ôh…ôr</th><th>Tarix</th><th>∆èm…ôliyyatlar</th></tr></thead><tbody>';
                
                snapshot.forEach((doc) => {
                    const job = doc.data();
                    const date = job.createdAt ? new Date(job.createdAt.toDate()).toLocaleDateString('az-AZ') : '-';
                    
                    html += `
                        <tr>
                            <td>${job.title}</td>
                            <td>${job.company}</td>
                            <td>${job.city}</td>
                            <td>${date}</td>
                            <td>
                                <button class="btn btn-view" onclick="viewJob('${doc.id}')">üëÅ</button>
                                <button class="btn btn-approve" onclick="quickApprove('${doc.id}')">‚úÖ</button>
                                <button class="btn btn-reject" onclick="quickReject('${doc.id}')">‚ùå</button>
                            </td>
                        </tr>
                    `;
                });
                
                html += '</tbody></table>';
                document.getElementById('pendingJobsList').innerHTML = html;
                
            } catch (err) {
                document.getElementById('pendingJobsList').innerHTML = '<p style="color: #e74c3c; padding: 20px;">X…ôta ba≈ü verdi!</p>';
            }
        }
        
        // Load approved jobs
        async function loadApprovedJobs() {
            try {
                const q = query(collection(db, 'jobs'), where('status', '==', 'approved'), orderBy('createdAt', 'desc'));
                const snapshot = await getDocs(q);
                
                if (snapshot.empty) {
                    document.getElementById('approvedJobsList').innerHTML = '<p style="color: #666; padding: 20px;">Aktiv elan yoxdur.</p>';
                    return;
                }
                
                let html = '<table><thead><tr><th>Vakansiya</th><th>≈ûirk…ôt</th><th>≈û…ôh…ôr</th><th>Baxƒ±≈ü</th><th>∆èm…ôliyyat</th></tr></thead><tbody>';
                
                snapshot.forEach((doc) => {
                    const job = doc.data();
                    
                    html += `
                        <tr>
                            <td>${job.title}</td>
                            <td>${job.company}</td>
                            <td>${job.city}</td>
                            <td>${job.views || 0}</td>
                            <td>
                                <button class="btn btn-view" onclick="viewJob('${doc.id}')">üëÅ Bax</button>
                            </td>
                        </tr>
                    `;
                });
                
                html += '</tbody></table>';
                document.getElementById('approvedJobsList').innerHTML = html;
                
            } catch (err) {
                document.getElementById('approvedJobsList').innerHTML = '<p style="color: #e74c3c; padding: 20px;">X…ôta ba≈ü verdi!</p>';
            }
        }
        
        // Load users
        async function loadUsers() {
            try {
                const snapshot = await getDocs(collection(db, 'users'));
                
                if (snapshot.empty) {
                    document.getElementById('usersList').innerHTML = '<p style="color: #666; padding: 20px;">ƒ∞stifad…ô√ßi yoxdur.</p>';
                    return;
                }
                
                let html = '<table><thead><tr><th>Ad Soyad</th><th>Email</th><th>Tip</th><th>Qeydiyyat tarixi</th></tr></thead><tbody>';
                
                snapshot.forEach((doc) => {
                    const user = doc.data();
                    const date = user.createdAt ? new Date(user.createdAt.toDate()).toLocaleDateString('az-AZ') : '-';
                    const typeText = user.userType === 'worker' ? 'üë§ ƒ∞≈ü axtaran' : 'üè¢ ƒ∞≈ü…ô g√∂t√ºr…ôn';
                    
                    html += `
                        <tr>
                            <td>${user.fullName || '-'}</td>
                            <td>${user.email}</td>
                            <td>${typeText}</td>
                            <td>${date}</td>
                        </tr>
                    `;
                });
                
                html += '</tbody></table>';
                document.getElementById('usersList').innerHTML = html;
                
            } catch (err) {
                document.getElementById('usersList').innerHTML = '<p style="color: #e74c3c; padding: 20px;">X…ôta ba≈ü verdi!</p>';
            }
        }
        
        // View job details
        window.viewJob = async function(jobId) {
            try {
                const docRef = doc(db, 'jobs', jobId);
                const docSnap = await getDoc(docRef);
                
                if (!docSnap.exists()) {
                    alert('Elan tapƒ±lmadƒ±!');
                    return;
                }
                
                const job = docSnap.data();
                currentJobId = jobId;
                
                const date = job.createdAt ? new Date(job.createdAt.toDate()).toLocaleString('az-AZ') : '-';
                const statusClass = job.status === 'approved' ? 'approved' : (job.status === 'rejected' ? 'rejected' : 'pending');
                const statusText = job.status === 'approved' ? '‚úÖ T…ôsdiql…ônib' : (job.status === 'rejected' ? '‚ùå R…ôdd edilib' : '‚è≥ G√∂zl…ôyir');
                
                document.getElementById('modalTitle').textContent = job.title;
                document.getElementById('modalBody').innerHTML = `
                    <div class="detail-row">
                        <label>üè¢ ≈ûirk…ôt:</label>
                        <div class="value">${job.company}</div>
                    </div>
                    <div class="detail-row">
                        <label>üìÅ Kateqoriya:</label>
                        <div class="value">${job.category}</div>
                    </div>
                    <div class="detail-row">
                        <label>üìç ≈û…ôh…ôr:</label>
                        <div class="value">${job.city}</div>
                    </div>
                    <div class="detail-row">
                        <label>üí∞ ∆èm…ôk haqqƒ±:</label>
                        <div class="value">${job.salary}</div>
                    </div>
                    <div class="detail-row">
                        <label>üìû ∆èlaq…ô:</label>
                        <div class="value">
                            üì± Telefon: ${job.phone}<br>
                            üìß Email: ${job.email || 'Yazƒ±lmayƒ±b'}
                        </div>
                    </div>
                    <div class="detail-row">
                        <label>üìù T…ôsvir:</label>
                        <div class="value"><pre>${job.description}</pre></div>
                    </div>
                    <div class="detail-row">
                        <label>üìä Status:</label>
                        <div class="value"><span class="status-badge ${statusClass}">${statusText}</span></div>
                    </div>
                    <div class="detail-row">
                        <label>üìÖ ∆èlav…ô edilib:</label>
                        <div class="value">${date}</div>
                    </div>
                    <div class="detail-row">
                        <label>üë§ ∆èlav…ô ed…ôn:</label>
                        <div class="value">${job.userEmail || 'Nam…ôlum'}</div>
                    </div>
                `;
                
                // Action buttons
                let buttons = '';
                if (job.status === 'pending') {
                    buttons = `
                        <button class="btn btn-approve" onclick="approveJob('${jobId}')">‚úÖ T…ôsdiql…ô</button>
                        <button class="btn btn-reject" onclick="rejectJob('${jobId}')">‚ùå R…ôdd et</button>
                    `;
                } else if (job.status === 'approved') {
                    buttons = `
                        <button class="btn btn-reject" onclick="rejectJob('${jobId}')">‚è™ G√∂zl…ôy…ôn…ô qaytar</button>
                    `;
                } else if (job.status === 'rejected') {
                    buttons = `
                        <button class="btn btn-approve" onclick="approveJob('${jobId}')">‚úÖ T…ôsdiql…ô</button>
                    `;
                }
                
                document.getElementById('modalActions').innerHTML = buttons + `
                    <button class="btn btn-view" onclick="closeModal()" style="margin-left: auto;">Baƒüla</button>
                `;
                
                document.getElementById('jobModal').classList.add('show');
                
            } catch (err) {
                alert('X…ôta: ' + err.message);
            }
        };
        
        // Close modal
        window.closeModal = function() {
            document.getElementById('jobModal').classList.remove('show');
            currentJobId = null;
        };
        
        // Quick approve
        window.quickApprove = async function(jobId) {
            if (!confirm('Bu elanƒ± t…ôsdiql…ôm…ôk ist…ôyirsiniz?')) return;
            
            try {
                await updateDoc(doc(db, 'jobs', jobId), { 
                    status: 'approved',
                    approvedAt: new Date()
                });
                alert('‚úÖ Elan t…ôsdiq edildi!');
                loadAllData();
            } catch (err) {
                alert('‚ùå X…ôta: ' + err.message);
            }
        };
        
        // Quick reject
        window.quickReject = async function(jobId) {
            if (!confirm('Bu elanƒ± r…ôdd etm…ôk ist…ôyirsiniz?')) return;
            
            try {
                await updateDoc(doc(db, 'jobs', jobId), { 
                    status: 'rejected',
                    rejectedAt: new Date()
                });
                alert('‚ùå Elan r…ôdd edildi!');
                loadAllData();
            } catch (err) {
                alert('‚ùå X…ôta: ' + err.message);
            }
        };
        
        // Approve from modal
        window.approveJob = async function(jobId) {
            await quickApprove(jobId);
            closeModal();
        };
        
        // Reject from modal
        window.rejectJob = async function(jobId) {
            await quickReject(jobId);
            closeModal();
        };
        
        // Close modal on outside click
        document.getElementById('jobModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // Enter key on login
        document.getElementById('adminPass').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') checkLogin();
        });
    </script>
</body>
</html>
